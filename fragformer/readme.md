Adapted from [KPGT](https://github.com/lihan97/KPGT)